(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     39767,        871]
NotebookOptionsPosition[     39404,        855]
NotebookOutlinePosition[     39747,        870]
CellTagsIndexPosition[     39704,        867]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"normalize", "[", "lst_", "]"}], " ", ":=", " ", 
    RowBox[{"lst", "/", 
     RowBox[{"Total", "[", "lst", "]"}]}]}], ";"}], " ", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"forward", "[", 
     RowBox[{"f_", ",", "A_", ",", "Bs_"}], "]"}], " ", ":=", " ", 
    RowBox[{"FoldList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", ".", 
        RowBox[{"Transpose", "[", "A", "]"}], ".", "#2"}], " ", "&"}], ",", 
      "f", ",", "Bs"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"scaledForward", "[", 
     RowBox[{"f_", ",", "A_", ",", "Bs_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"FoldList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", 
            RowBox[{"Total", "[", "#", "]"}]}], "}"}], "&"}], "[", 
         RowBox[{"#2", ".", 
          RowBox[{"Transpose", "[", "A", "]"}], ".", 
          RowBox[{"#1", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Bs", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ".", "f"}], ",", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"Bs", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ".", "f"}], "]"}]}], "}"}], ",", 
       RowBox[{"Bs", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"backward", "[", 
     RowBox[{"b_", ",", "A_", ",", "Bs_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Reverse", "[", 
     RowBox[{"FoldList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"A", ".", "#2", ".", "#1"}], " ", "&"}], ",", "b", ",", 
       RowBox[{"Reverse", "[", "Bs", "]"}]}], "]"}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"scaledBackward", "[", 
     RowBox[{"b_", ",", "A_", ",", "Bs_", ",", "l_"}], "]"}], " ", ":=", " ", 
    
    RowBox[{"Reverse", "[", 
     RowBox[{"FoldList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"A", ".", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ".", "#1"}], " ", "/", " ", 
         RowBox[{"#2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], " ", "&"}], ",", 
       RowBox[{"b", " ", "/", " ", 
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"Bs", ",", 
           RowBox[{"l", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"-", "2"}]}], "]"}], "]"}]}], "}"}], "]"}], "]"}]}], 
      "]"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"likelihood", "[", 
    RowBox[{"f_", ",", "A_", ",", "Bs_"}], "]"}], " ", ":=", "  ", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#1", " ", "+", " ", 
       RowBox[{"Log", "[", 
        RowBox[{"Total", "[", "#2", "]"}], "]"}]}], " ", "&"}], ",", "0", ",", 
     RowBox[{"forward", "[", 
      RowBox[{"f", ",", "A", ",", "Bs"}], "]"}]}], "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"forwardBackward", "[", 
     RowBox[{"fInit_", ",", "A_", ",", "Bs_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", "b", ",", "likelihood"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"forward", "[", 
         RowBox[{"fInit", ",", "A", ",", "Bs"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"b", " ", "=", " ", 
        RowBox[{"normalize", " ", "/@", " ", 
         RowBox[{"backward", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"Length", "[", "fInit", "]"}], "}"}]}], "]"}], ",", "A",
            ",", "Bs"}], "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"likelihood", " ", "=", " ", 
        RowBox[{"Fold", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", " ", "+", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"Total", "[", "#2", "]"}], "]"}]}], " ", "&"}], ",", "0",
           ",", "f"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"f", " ", 
        RowBox[{"normalize", " ", "/@", " ", "f"}]}], ";", "\n", "\t", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"f", ",", "b", ",", "likelihood"}], "}"}], "]"}], ";"}]}], 
     "\n", "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"normalize", "[", 
           RowBox[{"Times", " ", "@@", " ", "#"}], "]"}], " ", "&"}], " ", "/@",
          " ", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"f", ",", "b"}], "}"}], "]"}]}], "]"}], ";"}], "*)"}], 
     "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"scaledForwardBackward", "[", 
     RowBox[{"fInit_", ",", "A_", ",", "Bs_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", "l", ",", "b", ",", "likelihood"}], "}"}], ",", "\n",
       "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"f", ",", "l"}], "}"}], " ", "=", " ", 
        RowBox[{"scaledForward", "[", 
         RowBox[{"fInit", ",", "A", ",", "Bs"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"b", " ", "=", " ", 
        RowBox[{"scaledBackward", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "fInit", "]"}], "}"}]}], "]"}], ",", "A", 
          ",", "Bs", ",", "l"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"f", ",", "b"}], "}"}], "]"}], ";"}]}], "\n", "]"}]}], ";"}],
   "\n"}], "\n"}], "Code",
 CellChangeTimes->{{3.5284641355616913`*^9, 3.5284641491799603`*^9}, {
   3.5284650214962673`*^9, 3.528465107921493*^9}, {3.528465146332836*^9, 
   3.52846514708762*^9}, 3.528465234505928*^9, {3.528465328905599*^9, 
   3.528465453050489*^9}, 3.528465494618013*^9, {3.528465672040279*^9, 
   3.528465732579588*^9}, {3.528465810246277*^9, 3.528465860112893*^9}, {
   3.5284659139934072`*^9, 3.528465919918467*^9}, {3.528465958954472*^9, 
   3.528466028210794*^9}, {3.528466072546726*^9, 3.528466104322671*^9}, {
   3.5284661613713417`*^9, 3.5284662184892893`*^9}, {3.528466253132782*^9, 
   3.528466328074122*^9}, {3.528466358254092*^9, 3.5284664392303457`*^9}, {
   3.528466521035717*^9, 3.52846662343041*^9}, {3.528466670390461*^9, 
   3.5284666900520573`*^9}, {3.528466744509898*^9, 3.528466831514523*^9}, {
   3.528466874561318*^9, 3.52846687769396*^9}, {3.528466938019751*^9, 
   3.5284670013321877`*^9}, {3.528467062493482*^9, 3.5284670629040947`*^9}, {
   3.5284671837825603`*^9, 3.528467196885888*^9}, {3.5284672381204157`*^9, 
   3.528467242957307*^9}, 3.52847096586987*^9, {3.5285189726589737`*^9, 
   3.528519012771215*^9}, {3.528519050446576*^9, 3.5285191473012342`*^9}, {
   3.528519210435738*^9, 3.528519322044531*^9}, {3.528522612028235*^9, 
   3.528522654678581*^9}, {3.528526257124495*^9, 3.528526273171452*^9}, {
   3.528529163289345*^9, 3.528529195026369*^9}, {3.528535229171177*^9, 
   3.5285352737325497`*^9}, {3.528535686070822*^9, 3.5285358263943987`*^9}, {
   3.528535856518338*^9, 3.5285358671176453`*^9}, {3.528535913039383*^9, 
   3.528536269122116*^9}, {3.528536515533698*^9, 3.528536656094887*^9}, {
   3.5285366998209143`*^9, 3.528536735086837*^9}, {3.5285368187969933`*^9, 
   3.528536851063094*^9}, {3.52853710536057*^9, 3.52853717102849*^9}, {
   3.528537252643354*^9, 3.528537259869914*^9}, {3.528537309869676*^9, 
   3.5285373403579893`*^9}, {3.5285374029670973`*^9, 3.528537411858485*^9}, {
   3.5285374808329477`*^9, 3.528537527619011*^9}, {3.528537590724575*^9, 
   3.528537637942648*^9}, {3.528537676149372*^9, 3.528537880074132*^9}, 
   3.528537914747767*^9, {3.528537986723781*^9, 3.52853798923742*^9}, {
   3.52853802262551*^9, 3.528538035847554*^9}, {3.5285380950488243`*^9, 
   3.528538095160171*^9}, {3.5285381823423433`*^9, 3.52853821269213*^9}, {
   3.528538257492552*^9, 3.528538283752592*^9}, {3.528538317055097*^9, 
   3.528538344056024*^9}, {3.5285386240005407`*^9, 3.528538626621111*^9}, {
   3.528538723020784*^9, 3.528538735153748*^9}, {3.528538774355143*^9, 
   3.528538916548728*^9}, {3.5285389699741497`*^9, 3.52853898638146*^9}, {
   3.528539161950487*^9, 3.5285393067133293`*^9}, {3.5285393446706*^9, 
   3.5285393549439793`*^9}, {3.528539418885459*^9, 3.5285394285398684`*^9}, {
   3.5285394719208527`*^9, 3.528539473375786*^9}, {3.528539568394833*^9, 
   3.528539586137491*^9}, 3.528539634714426*^9, {3.528539718580271*^9, 
   3.528539752335771*^9}, {3.528539787396961*^9, 3.528539810960807*^9}, {
   3.5285398873586063`*^9, 3.5285399046222563`*^9}, {3.528541525155673*^9, 
   3.528541535429987*^9}, {3.5285484556689606`*^9, 3.528548471557869*^9}, {
   3.528553938655569*^9, 3.5285539393986115`*^9}, {3.52855411244751*^9, 
   3.5285541155026846`*^9}, {3.5285542030476913`*^9, 
   3.5285542163674536`*^9}, {3.528554280495121*^9, 3.5285543352252517`*^9}, {
   3.528558004754137*^9, 3.5285580115305243`*^9}, {3.528558051242796*^9, 
   3.5285580518898325`*^9}, {3.5285583716111193`*^9, 3.528558380952654*^9}, {
   3.5285590073394814`*^9, 3.52855901780508*^9}, {3.528559075059355*^9, 
   3.528559075379373*^9}, {3.5285591198349156`*^9, 3.528559121546014*^9}, {
   3.528559169962783*^9, 3.5285591747640576`*^9}, 3.5285593344831924`*^9, 
   3.5285594244828267`*^9, {3.528561070882572*^9, 3.5285610735851135`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.528535868129458*^9, 3.528535869205042*^9}, {
  3.5285378296910667`*^9, 3.5285378309738703`*^9}, {3.5285608414720283`*^9, 
  3.528560844582206*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"findCalcB", "[", 
     RowBox[{"mu_", ",", " ", "sigma_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{"frame", ",", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PDF", "[", 
          RowBox[{
           RowBox[{"MultinormalDistribution", "[", 
            RowBox[{
             RowBox[{"mu", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"sigma", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", "frame"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "mu", "]"}]}], "}"}]}], "]"}], "]"}]}], 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"newModel", "[", 
     RowBox[{"{", 
      RowBox[{"A_", ",", "mu_", ",", "sigma_"}], "}"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "calcB", "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"calcB", " ", "=", " ", 
        RowBox[{"findCalcB", "[", 
         RowBox[{"mu", ",", "sigma"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"Return", "[", 
        RowBox[{"Function", "[", 
         RowBox[{"frames", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"likelihood", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{"0.5", ",", 
                RowBox[{"Length", "[", "A", "]"}]}], "]"}], ",", "A", ",", 
              RowBox[{"calcB", " ", "/@", " ", "frames"}]}], "]"}], ")"}], 
           "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ";"}]}], "\n", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"addModel", "[", 
     RowBox[{"classifier_", ",", "word_", ",", "model_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Append", "[", 
     RowBox[{"classifier", ",", 
      RowBox[{"{", 
       RowBox[{"word", ",", "model"}], "}"}]}], "]"}]}], ";"}], "\n"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"classify", "[", 
     RowBox[{"classifier_", ",", "frames_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Ordering", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "frames", "]"}]}], "}"}], 
        " ", "&"}], " ", "/@", " ", "classifier"}], ",", "1", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", ">", " ", 
        RowBox[{"#2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], " ", "&"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"emInit", "[", 
     RowBox[{"Os_", ",", " ", "N_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "A", ",", "prior", ",", " ", "mu", ",", " ", "sigma", ",", "D", ",", 
        "mean"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"D", " ", "=", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"Os", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Generate", " ", "a", " ", "random", " ", "prior"}], " ", 
        "*)"}], "\n", "\t", 
       RowBox[{"prior", " ", "=", " ", 
        RowBox[{"normalize", "[", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.01", ",", " ", "0.99"}], "}"}], ",", "N"}], "]"}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Generate", " ", "a", " ", "random", " ", "transition", " ", "matrix",
          " ", "A"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"normalize", " ", "/@", " ", 
         RowBox[{"(", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.01", ",", " ", "0.99"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"N", ",", "N"}], "}"}]}], "]"}], ")"}]}]}], ";", "\n", 
       "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"mu", ",", " ", 
         RowBox[{"for", " ", "each", " ", "state"}]}], " ", "*)"}], "\n", 
       "\t", 
       RowBox[{"mu", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{"0.01", ",", "0.99"}], "}"}], "]"}], " ", "*", " ", 
             RowBox[{"Mean", "[", "#", "]"}]}], " ", "&"}], " ", "/@", " ", 
           RowBox[{"Transpose", "[", "Os", "]"}]}], ",", 
          RowBox[{"{", "N", "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"sigma", ",", " ", 
         RowBox[{"for", " ", "each", " ", "state"}]}], " ", "*)"}], "\n", 
       "\t", 
       RowBox[{"sigma", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", ".", 
             RowBox[{"Transpose", "[", "#", "]"}]}], " ", "&"}], "[", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.01", ",", "0.99"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"D", ",", "D"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", "N", "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"prior", ",", "A", ",", "mu", ",", "sigma", ",", "Os"}], 
         "}"}], "]"}], ";"}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"emStep", "[", 
     RowBox[{"{", 
      RowBox[{"prior_", ",", "A_", ",", "mu_", ",", "sigma_", ",", "Os_"}], 
      "}"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "T", ",", "S", ",", "F", ",", "r", ",", "f", ",", "muj", ",", "sum", 
        ",", "\[Gamma]", ",", "\[Xi]", ",", "likelihood", ",", "gamma", ",", 
        "xi", ",", "Aden", ",", "Anum", ",", "i", ",", "j", ",", "t", ",", 
        "k", ",", "l", ",", "calcB", ",", "newPi", ",", "newA", ",", "newMu", 
        ",", "newSigma"}], "}"}], ",", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Do", " ", "step"}], " ", "*)"}], " ", "\n", "\t", 
      RowBox[{
       RowBox[{"T", " ", "=", " ", 
        RowBox[{"Length", "[", "Os", "]"}]}], ";", "\n", "\t", 
       RowBox[{"S", " ", "=", " ", 
        RowBox[{"Length", "[", "A", "]"}]}], ";", "\n", "\t", 
       RowBox[{"F", " ", "=", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"Os", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\n", "\t", "\n", 
       "\t", 
       RowBox[{"calcB", " ", "=", " ", 
        RowBox[{"findCalcB", "[", 
         RowBox[{"mu", ",", "sigma"}], "]"}]}], ";", "\n", "\t", "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"f", ",", "r"}], "}"}], " ", "=", " ", 
        RowBox[{"scaledForwardBackward", "[", 
         RowBox[{"prior", ",", "A", ",", 
          RowBox[{"calcB", " ", "/@", " ", "Os"}]}], "]"}]}], ";", "\n", "\n",
        "\t", 
       RowBox[{"\[Gamma]", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"normalize", "[", 
           RowBox[{"Times", " ", "@@", " ", "#"}], "]"}], " ", "&"}], " ", "/@",
          " ", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"f", ",", "r"}], "}"}], "]"}]}]}], ";", "\n", "\n", "\t", 
       RowBox[{"newMu", " ", "=", " ", 
        RowBox[{"Table", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Gamma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"t", ",", "j"}], "]"}], "]"}], " ", "*", " ", 
                RowBox[{"Os", "[", 
                 RowBox[{"[", "t", "]"}], "]"}]}], ")"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "T"}], "}"}]}], "]"}], "]"}], " ", "/", " ", 
           
           RowBox[{"Total", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"\[Gamma]", "[", 
               RowBox[{"[", 
                RowBox[{"t", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "T"}], "}"}]}], "]"}], "]"}]}], ",", "\n", 
          "\t\t", 
          RowBox[{"{", 
           RowBox[{"j", ",", "S"}], "}"}]}], "\n", "\t", "]"}]}], ";", "\n", 
       "\t", "\n", "\t", 
       RowBox[{"newSigma", " ", "=", " ", 
        RowBox[{"Table", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"[", 
                 RowBox[{"t", ",", "j"}], "]"}], "]"}], " ", "*", " ", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Os", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], " ", "-", " ", 
                   RowBox[{"newMu", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Os", "[", 
                   RowBox[{"[", "t", "]"}], "]"}], " ", "-", " ", 
                  RowBox[{"newMu", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "T"}], "}"}]}], "]"}], "]"}], " ", "/", " ", 
           
           RowBox[{"Total", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"\[Gamma]", "[", 
               RowBox[{"[", 
                RowBox[{"t", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "T"}], "}"}]}], "]"}], "]"}]}], ",", "\n", 
          "\t\t", 
          RowBox[{"{", 
           RowBox[{"j", ",", "S"}], "}"}]}], "\n", "\t", "]"}]}], ";", "\n", 
       "\n", "\t", 
       RowBox[{"newPi", " ", "=", " ", 
        RowBox[{"\[Gamma]", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t", "\n", "\t", 
       RowBox[{"\[Xi]", " ", "=", " ", 
        RowBox[{"Table", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"sum", " ", "=", " ", 
            RowBox[{"Total", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"[", 
                  RowBox[{"t", ",", "k"}], "]"}], "]"}], " ", "*", " ", 
                RowBox[{"A", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "l"}], "]"}], "]"}], " ", "*", " ", 
                RowBox[{
                 RowBox[{"calcB", "[", 
                  RowBox[{"Os", "[", 
                   RowBox[{"[", 
                    RowBox[{"t", "+", "1"}], "]"}], "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", "l"}], "]"}], "]"}], " ", "*", " ", 
                RowBox[{"r", "[", 
                 RowBox[{"[", 
                  RowBox[{"t", ",", "l"}], "]"}], "]"}]}], " ", ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "S"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", "S"}], "}"}]}], "]"}], "]"}]}], ";", "\n", 
           "\t\t", 
           RowBox[{"Print", "[", "sum", "]"}], ";", "\n", "\t\t", 
           RowBox[{"Table", "[", "\t", "\n", "\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"[", 
                  RowBox[{"t", ",", "i"}], "]"}], "]"}], " ", "*", " ", 
                RowBox[{"A", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "*", " ", 
                RowBox[{
                 RowBox[{"calcB", "[", 
                  RowBox[{"Os", "[", 
                   RowBox[{"[", 
                    RowBox[{"t", "+", "1"}], "]"}], "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "j"}], "]"}], "]"}], " ", "*", " ", 
                RowBox[{"r", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"t", "+", "1"}], ",", "j"}], "]"}], "]"}]}], ")"}],
               " ", "/", " ", "sum"}], ",", "\n", "\t\t\t", 
             RowBox[{"{", 
              RowBox[{"i", ",", "S"}], "}"}], ",", "\n", "\t\t\t", 
             RowBox[{"{", 
              RowBox[{"j", ",", "S"}], "}"}]}], "\t\t", "\n", "\t\t", "]"}]}],
           ",", "\n", "\t\t", 
          RowBox[{"{", 
           RowBox[{"t", ",", 
            RowBox[{"T", " ", "-", " ", "1"}]}], "}"}]}], "\n", "\t", "]"}]}],
        ";", "\n", "\t", "\n", "\t", 
       RowBox[{"newA", " ", "=", " ", 
        RowBox[{"Table", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Xi]", "[", 
                RowBox[{"[", 
                 RowBox[{"t", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "T"}], "}"}]}], "]"}], "]"}], " ", "/", " ", 
            RowBox[{"Total", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"[", 
                 RowBox[{"t", ",", "j"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "T"}], "}"}]}], "]"}], "]"}]}], ";", "\n", 
           "\t\t", 
           RowBox[{"{", 
            RowBox[{"i", ",", "S"}], "}"}]}], ",", "\n", "\t\t", 
          RowBox[{"{", 
           RowBox[{"j", ",", "S"}], "}"}]}], "\n", "\t", "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
         "newPi", ",", "newA", ",", "newMu", ",", "newSigma", ",", "Os"}], 
         "}"}], "]"}], ";"}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"baumWelch", "[", 
    RowBox[{"frames_", ",", "N_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "pi", ",", "A", ",", "mu", ",", "sigma", ",", "diff", ",", 
       "lastLikelihood", ",", "test"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"diff", " ", "=", " ", "0.00001"}], ";", "\n", "\t", 
      RowBox[{"lastLikelihood", " ", "=", " ", "0"}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"test", "[", 
        RowBox[{"{", 
         RowBox[{"pi_", ",", "A_", ",", "mu_", ",", "sigma_", ",", "Os_"}], 
         "}"}], "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"logLike", ",", "continue"}], "}"}], ",", "\n", "\t\t", 
         RowBox[{
          RowBox[{"logLike", " ", "=", " ", 
           RowBox[{"likelihood", "[", 
            RowBox[{"pi", ",", "A", ",", 
             RowBox[{
              RowBox[{"findCalcB", "[", 
               RowBox[{"mu", ",", "sigma"}], "]"}], " ", "/@", " ", "Os"}]}], 
            "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"continue", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"logLike", " ", "-", " ", "lastLikelihood"}], ")"}], " ",
             "<", " ", "diff"}]}], ";", " \t\t", "\n", "\t\t", 
          RowBox[{"lastLikelihood", " ", "=", " ", "logLike"}], ";", "\n", 
          "\t\t", 
          RowBox[{"Return", "[", "continue", "]"}], ";"}]}], "\n", "\t", 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pi", ",", "A", ",", "mu", ",", "sigma", ",", "frames"}], 
        "}"}], " ", "=", " ", 
       RowBox[{"Nest", "[", 
        RowBox[{"emStep", ",", 
         RowBox[{"{", 
          RowBox[{"emInit", "[", 
           RowBox[{"frames", ",", "N"}], "]"}], "}"}], ",", "test"}], "]"}]}],
       ";", "\n", "\t", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"A", ",", "mu", ",", "sigma"}], "}"}], "]"}], ";"}]}], "\n", 
    "]"}]}], ";"}], "\n", 
 RowBox[{"\t"}]}], "Code",
 CellChangeTimes->{{3.5284643215874023`*^9, 3.528464367155505*^9}, {
   3.5284647836614027`*^9, 3.528464784117384*^9}, {3.528464827103026*^9, 
   3.528464827480221*^9}, {3.5284651415887337`*^9, 3.528465142602221*^9}, {
   3.5284673460565023`*^9, 3.5284674611407948`*^9}, {3.5284675441262817`*^9, 
   3.528467583784881*^9}, {3.528467622863676*^9, 3.5284676462026787`*^9}, {
   3.528468541013771*^9, 3.528468611593236*^9}, {3.5284697780698423`*^9, 
   3.528469816019204*^9}, {3.528469852736714*^9, 3.5284702725153017`*^9}, {
   3.528470312222271*^9, 3.528470372715542*^9}, {3.5284704750256557`*^9, 
   3.528470564079028*^9}, {3.5284706161590443`*^9, 3.5284710183383617`*^9}, {
   3.528471059885613*^9, 3.528471094826582*^9}, {3.528471126944384*^9, 
   3.5284711314904346`*^9}, {3.52847124650828*^9, 3.528471882285986*^9}, {
   3.5284719891127577`*^9, 3.528472024167719*^9}, {3.528472086223473*^9, 
   3.5284720902389812`*^9}, {3.528472137808695*^9, 3.5284721399674263`*^9}, 
   3.528472184837594*^9, {3.528472343817004*^9, 3.528472368472747*^9}, {
   3.528472439200349*^9, 3.5284724780290728`*^9}, {3.5284725431334057`*^9, 
   3.528472547844396*^9}, {3.5284727114511347`*^9, 3.528472787245296*^9}, {
   3.52847289101145*^9, 3.528473066280705*^9}, {3.5284731296191483`*^9, 
   3.5284732107013893`*^9}, {3.528473241670114*^9, 3.5284733519018908`*^9}, {
   3.528473422166746*^9, 3.52847342231474*^9}, {3.5284734880323133`*^9, 
   3.528473490570602*^9}, {3.528473539138309*^9, 3.5284735760701313`*^9}, {
   3.528473618392252*^9, 3.528474140304696*^9}, {3.528474180302877*^9, 
   3.528474186820485*^9}, {3.528474249611058*^9, 3.528474366856411*^9}, {
   3.528474411659462*^9, 3.528474435880466*^9}, {3.528474471695754*^9, 
   3.528474503774836*^9}, {3.5284745471280212`*^9, 3.528474669778159*^9}, {
   3.52847473630236*^9, 3.528475101126464*^9}, {3.528475143107142*^9, 
   3.528475189280572*^9}, {3.5284752213638353`*^9, 3.528475305899475*^9}, {
   3.528475414445208*^9, 3.5284754165313463`*^9}, {3.5284754850202637`*^9, 
   3.528475543083788*^9}, {3.528475604286025*^9, 3.528475646769153*^9}, {
   3.5284756985238533`*^9, 3.528475815505025*^9}, {3.528475889637979*^9, 
   3.5284759916524773`*^9}, {3.528476123088107*^9, 3.5284761828695793`*^9}, {
   3.528476317497603*^9, 3.528476349912757*^9}, {3.528476397214714*^9, 
   3.528476503984029*^9}, {3.5284765466007633`*^9, 3.528476605779242*^9}, {
   3.5284766609872713`*^9, 3.5284768464223337`*^9}, {3.528476903039845*^9, 
   3.5284769229810963`*^9}, {3.528476953191127*^9, 3.5284769668505983`*^9}, {
   3.528477038783506*^9, 3.5284771251137943`*^9}, {3.5284771986272907`*^9, 
   3.528477200186459*^9}, {3.5285194391104803`*^9, 3.528519824514439*^9}, {
   3.528519860655216*^9, 3.528519872146956*^9}, {3.5285199200755577`*^9, 
   3.528519966133605*^9}, {3.528520003215228*^9, 3.528520008870281*^9}, {
   3.528520079724893*^9, 3.5285202915315447`*^9}, {3.52852032473308*^9, 
   3.528520416797536*^9}, {3.528520491821548*^9, 3.528520596162504*^9}, {
   3.5285206418056383`*^9, 3.528520766752233*^9}, {3.528520818219761*^9, 
   3.528520953535207*^9}, {3.528520987423252*^9, 3.52852147298424*^9}, {
   3.5285215167706614`*^9, 3.52852155809624*^9}, {3.5285216078271627`*^9, 
   3.528522502605398*^9}, {3.52852274516821*^9, 3.528522956308982*^9}, {
   3.528523108613533*^9, 3.528523132439752*^9}, {3.52852324150143*^9, 
   3.528523276936351*^9}, {3.528523361461187*^9, 3.528523414673038*^9}, {
   3.5285234585059032`*^9, 3.528523519833885*^9}, {3.528523669574368*^9, 
   3.528523713205598*^9}, 3.528523748022893*^9, {3.5285238217261467`*^9, 
   3.528523824088479*^9}, {3.5285238739573183`*^9, 3.5285238879665213`*^9}, {
   3.528523924972815*^9, 3.52852398769589*^9}, 3.52852402624209*^9, {
   3.528524057162772*^9, 3.5285241459578733`*^9}, {3.52852428563717*^9, 
   3.528524314003756*^9}, {3.5285243647452803`*^9, 3.528524371240945*^9}, {
   3.528524444069858*^9, 3.52852444600488*^9}, {3.528524542922484*^9, 
   3.528524545708006*^9}, {3.528524798682201*^9, 3.52852480751403*^9}, 
   3.5285253525756474`*^9, {3.528525387645269*^9, 3.5285254015596533`*^9}, {
   3.528525533817253*^9, 3.528525554746943*^9}, {3.528525718407537*^9, 
   3.528525718538048*^9}, {3.528526329474106*^9, 3.5285263444471397`*^9}, {
   3.5285263931416073`*^9, 3.528526401673882*^9}, {3.5285265091337147`*^9, 
   3.5285265092734737`*^9}, {3.528527061419282*^9, 3.528527081880939*^9}, {
   3.528527128137108*^9, 3.528527155352069*^9}, {3.528527240057516*^9, 
   3.528527402402594*^9}, {3.5285275958323097`*^9, 3.5285277926559*^9}, {
   3.52852792423741*^9, 3.5285279316015377`*^9}, {3.528527963745925*^9, 
   3.528528002320827*^9}, {3.528528162302772*^9, 3.528528241327799*^9}, {
   3.528528299462029*^9, 3.52852830907277*^9}, {3.528528339963991*^9, 
   3.528528381363916*^9}, {3.528528412656885*^9, 3.5285284222325897`*^9}, {
   3.528528494389263*^9, 3.52852851325807*^9}, {3.528528573998884*^9, 
   3.528528762628027*^9}, {3.528528793990863*^9, 3.528528845649197*^9}, {
   3.528528887699497*^9, 3.528528890945325*^9}, {3.528528929838415*^9, 
   3.5285289435881453`*^9}, {3.528529026793954*^9, 3.528529029634884*^9}, {
   3.528529100561862*^9, 3.5285291074102716`*^9}, 3.528529241184185*^9, {
   3.528529286664797*^9, 3.5285292952186737`*^9}, {3.5285294432625217`*^9, 
   3.5285294433957367`*^9}, {3.528529535272018*^9, 3.528529539581017*^9}, {
   3.528529693632889*^9, 3.5285297109017487`*^9}, {3.528529844646577*^9, 
   3.528529907286784*^9}, {3.5285299477563066`*^9, 3.5285300091435747`*^9}, {
   3.528530065813591*^9, 3.528530066348538*^9}, {3.52853037909035*^9, 
   3.528530391732107*^9}, {3.528530591775074*^9, 3.528530640182703*^9}, {
   3.528530685008542*^9, 3.528530703993791*^9}, {3.5285308264903803`*^9, 
   3.528530847021874*^9}, {3.52853088840097*^9, 3.528530994567041*^9}, {
   3.5285310354800663`*^9, 3.528531189078878*^9}, {3.5285312501044273`*^9, 
   3.528531262943688*^9}, {3.528531302490932*^9, 3.528531423352598*^9}, {
   3.528531470841899*^9, 3.5285315053689337`*^9}, {3.52853206687175*^9, 
   3.528532097591782*^9}, {3.528532186497899*^9, 3.528532242140297*^9}, {
   3.5285322857238693`*^9, 3.52853239686618*^9}, {3.528532441716524*^9, 
   3.528532475969912*^9}, {3.528532634179974*^9, 3.52853264060011*^9}, {
   3.528532673015036*^9, 3.5285326750249434`*^9}, {3.528532750139606*^9, 
   3.5285328728042803`*^9}, {3.528532941700769*^9, 3.528532958841695*^9}, {
   3.5285329895874434`*^9, 3.528532998615108*^9}, {3.528533044997446*^9, 
   3.5285330528957453`*^9}, {3.528533098158977*^9, 3.528533100472622*^9}, {
   3.528533145896817*^9, 3.528533157694744*^9}, {3.528533200773706*^9, 
   3.528533231918138*^9}, {3.528533278828361*^9, 3.528533279713697*^9}, {
   3.5285333342671432`*^9, 3.528533380661675*^9}, {3.528533448753457*^9, 
   3.528533473589039*^9}, {3.528533542268305*^9, 3.528533565005926*^9}, 
   3.5285336203418903`*^9, {3.528533677726776*^9, 3.5285336782629766`*^9}, {
   3.528533710209025*^9, 3.528533747661922*^9}, {3.528533786964299*^9, 
   3.528533817856468*^9}, {3.528533854036089*^9, 3.528533857651682*^9}, {
   3.5285339159070168`*^9, 3.52853392030512*^9}, {3.528533961763269*^9, 
   3.528534033538341*^9}, {3.528534157015711*^9, 3.528534173988282*^9}, {
   3.528534247832513*^9, 3.5285344285251207`*^9}, {3.5285344648058357`*^9, 
   3.528534519150958*^9}, {3.5285345595552464`*^9, 3.528534636907792*^9}, {
   3.528534680659878*^9, 3.528534696903792*^9}, {3.52853482492047*^9, 
   3.528534851392721*^9}, {3.528539858677989*^9, 3.528539866541973*^9}, {
   3.5285399410416603`*^9, 3.528539961839632*^9}, {3.528540115135079*^9, 
   3.528540118661475*^9}, {3.52854025713153*^9, 3.5285402582146063`*^9}, {
   3.5285403343767147`*^9, 3.528540445231304*^9}, {3.528540503432521*^9, 
   3.5285405561889544`*^9}, {3.528540587312132*^9, 3.5285407443413773`*^9}, {
   3.528540775007525*^9, 3.5285409359820557`*^9}, {3.528540987224764*^9, 
   3.528540997625245*^9}, 3.5285410314918737`*^9, {3.528541197355525*^9, 
   3.5285412451621313`*^9}, {3.52854130203017*^9, 3.528541307635439*^9}, {
   3.5285413409476852`*^9, 3.528541347594833*^9}, {3.5285413949333143`*^9, 
   3.528541429525251*^9}, {3.528541459841151*^9, 3.528541466981331*^9}, {
   3.528541564507124*^9, 3.528541567183622*^9}, {3.528541618342526*^9, 
   3.5285416858862333`*^9}, {3.5285417408584414`*^9, 3.528541765572343*^9}, {
   3.528541841615876*^9, 3.5285418469045258`*^9}, {3.528541881277018*^9, 
   3.528541881920431*^9}, {3.528541965153687*^9, 3.528542005189886*^9}, {
   3.528542036687358*^9, 3.52854208658735*^9}, {3.528542130360138*^9, 
   3.5285421654515047`*^9}, {3.528542236559332*^9, 3.52854223865446*^9}, {
   3.528542289010922*^9, 3.528542310460863*^9}, {3.5285423464269238`*^9, 
   3.528542355636806*^9}, {3.5285424085676947`*^9, 3.5285424086827602`*^9}, {
   3.5285425187377577`*^9, 3.528542641809951*^9}, {3.528548366359852*^9, 
   3.5285483749333425`*^9}, {3.52854855234949*^9, 3.528548750175805*^9}, {
   3.528548944305909*^9, 3.5285492313763285`*^9}, {3.5285493427726994`*^9, 
   3.52854941182965*^9}, {3.528549519060783*^9, 3.5285495803672895`*^9}, {
   3.5285496208656054`*^9, 3.5285497903623004`*^9}, {3.5285498883919077`*^9, 
   3.5285499156134644`*^9}, {3.5285499465462337`*^9, 
   3.5285499866065245`*^9}, {3.52855003792546*^9, 3.5285501167739697`*^9}, {
   3.5285501838158045`*^9, 3.5285502049370127`*^9}, {3.5285502351107388`*^9, 
   3.528550386914421*^9}, {3.528550420274329*^9, 3.5285504499360256`*^9}, {
   3.5285504911603837`*^9, 3.5285505264744034`*^9}, {3.5285505698298836`*^9, 
   3.528550680950239*^9}, {3.5285507804939327`*^9, 3.528550812070739*^9}, {
   3.5285508556682324`*^9, 3.528550870768096*^9}, {3.528550933585689*^9, 
   3.5285509497466135`*^9}, {3.5285509980723777`*^9, 3.528551078867999*^9}, 
   3.52855115668945*^9, 3.5285512144677544`*^9, {3.528551468402279*^9, 
   3.5285514844651976`*^9}, {3.5285515153389635`*^9, 3.528551563996746*^9}, {
   3.5285518017533455`*^9, 3.528551808164712*^9}, {3.5285518478809834`*^9, 
   3.528551925140403*^9}, {3.528551970887019*^9, 3.528552003977912*^9}, {
   3.5285520457393007`*^9, 3.528552049386509*^9}, {3.528552115628298*^9, 
   3.52855213175222*^9}, {3.5285524339935074`*^9, 3.528552435471592*^9}, {
   3.528552510530885*^9, 3.5285525487520714`*^9}, {3.5285525912595024`*^9, 
   3.528552607153412*^9}, {3.5285526389612308`*^9, 3.5285526413273664`*^9}, {
   3.5285528111950817`*^9, 3.528552853106479*^9}, {3.528552895026877*^9, 
   3.5285529528121824`*^9}, {3.5285530203120427`*^9, 
   3.5285530582052107`*^9}, {3.528553096720413*^9, 3.52855357395671*^9}, {
   3.5285537700139236`*^9, 3.5285538545277576`*^9}, 3.5285538961301365`*^9, {
   3.528554537336812*^9, 3.5285545375368233`*^9}, {3.52855486966782*^9, 
   3.5285549447621155`*^9}, {3.528555026957816*^9, 3.528555125905476*^9}, {
   3.528555189174095*^9, 3.528555204109949*^9}, {3.5285552729628873`*^9, 
   3.5285554938945236`*^9}, {3.528555534880868*^9, 3.5285556081800604`*^9}, {
   3.5285556504424777`*^9, 3.52855565642482*^9}, {3.5285556964571095`*^9, 
   3.5285557397245846`*^9}, {3.528556274835191*^9, 3.5285562791274366`*^9}, {
   3.5285564232856817`*^9, 3.528556423405689*^9}, {3.528556700995566*^9, 
   3.528556709879074*^9}, {3.528556764378191*^9, 3.5285568000842333`*^9}, {
   3.528556840336536*^9, 3.528556848745017*^9}, {3.5285571625589657`*^9, 
   3.5285572249635353`*^9}, {3.52855734113918*^9, 3.52855741229825*^9}, {
   3.5285574543286543`*^9, 3.528557455671731*^9}, {3.528557536220338*^9, 
   3.528557540694594*^9}, {3.5285577018188095`*^9, 3.5285577105033064`*^9}, {
   3.5285577637133503`*^9, 3.5285578038976483`*^9}, {3.528557881694098*^9, 
   3.5285578837002125`*^9}, {3.5285579214073696`*^9, 
   3.5285579478098793`*^9}, {3.5285581430270452`*^9, 
   3.5285581768929825`*^9}, {3.528558227813895*^9, 3.528558254689432*^9}, {
   3.5285588011396875`*^9, 3.5285588062249784`*^9}, {3.52856094298897*^9, 
   3.5285609475190406`*^9}, {3.528560991261349*^9, 3.528561024479359*^9}, {
   3.5285610923629017`*^9, 3.528561097605482*^9}, {3.5285611443587008`*^9, 
   3.52856115015129*^9}, {3.5285611848418226`*^9, 3.5285611950094786`*^9}}],

Cell[BoxData["-"], "Input",
 CellChangeTimes->{3.52855019107622*^9}]
},
WindowSize->{1904, 923},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 9895, 229, 588, "Code"],
Cell[10455, 251, 196, 3, 31, "Input"],
Cell[10654, 256, 28675, 594, 1628, "Code"],
Cell[39332, 852, 68, 1, 31, "Input"]
}
]
*)

(* End of internal cache information *)
